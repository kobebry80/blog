---
layout: default
title:  "论研发的正确姿势"
date:   2016-07-25
categories: devops
---

Hello，大家好，“妮妲”已经抵达深圳，外面风急雨骤，希望一切安好。

前段时间有篇帖子讲华为基本不懂研发的帖子很火，从组织、流程、环境、工具等各个方面痛陈华为研发的缺点和问题。

从个人几年的体验来看，很多地方确实非常有道理，有兴趣的同学可以挖来看看。帖子叫：“华为该炸掉研发金字塔的时候了。”

今天我们不评论帖子本身的好坏，只谈这几年在研发体系对于研发的亲身体验，来谈一谈云时代研发的正确姿势，欢迎一起探讨。

## 1. 用户体验
云计算让IT变得无处不在，最终用户能够以非常低的成本&非常容易的获取到各类IT资源，最终用户的体验将会越来越重要。

就如同DaoCloud book所说的：
>在“互联网＋”时代，用户就是最好的产品经理，业务更替越来越频繁，如何更快，更好的满足用户的需求决定着企业的商业竞争力。

对于IT研发来说，这无疑是一个最好的时代，我们既是云的开发者，又是云的受益者。热爱新事物，喜欢尝试程序猿们本身就是云上最富有热情，也是最重要的用户群体。

互联网喜欢把用户分为前卫用户（10%），普通用户（80%），保守用户（10％），那么云计算的用户中程序猿一定是那前卫10%中的了。

毕竟谁也不希望自己搬服务器，插硬盘，插网线，安装OS，我们只想安静的做个美男子而已。

那么云研发是否弄个牛逼的VM就满足程序猿的需求了呢？显然不是嘛，不然咋会出现GAE，CloudFoundry，Docker。包括最近很火的serverless —— AWS的Lambda。

一切都是为了让研发更爽、更轻松、更自动化。有了这些，DevOps才是可以实现的，如果真让程序猿人肉去运维，估计没多久就废了。

那么什么才是云研发的正确姿势呢？当然每个团队&个人都有不同的感受，我只从自己的一些经验来简单总结下。

## 2. 研发的正确姿势

大家都在讲Google，Facebook研发体验好？到底好在哪里？到底研发体验有哪几个关键考核点？

直接google搜 “研发体验”，汗死，居然没有匹配词，只在知乎上有各家研发体验的讨论。

贴一段：

>之前在鹅厂和某小厂干过.从鹅厂跳槽去某小厂的时候,当时就感觉跟鹅厂比起来那家小厂的内部系统就是一坨翔.但是来了google后,我发现鹅厂的内部it系统文档系统代码质量都是一坨翔.

到底小厂，鹅厂，google研发体验差距多大？没有体验，不敢乱说。

建议大家看看“How google works” 和 王淮的“打造Facebook”。

但是从我个人感觉来看，在一个组织呆久了，一定会有各种无力感，这种无力感来得越早可能研发体验越不好。

那么云时代的研发到底如何玩？

### 开发工具&平台
云时代的研发首先得找个研发平台，直接几台笔记本，再扛几台服务器就开始干研发是不合适的。

当今时代，还没玩过AWS，阿里云，Daocloud之类云平台的程序猿不是合格的云程序猿。

研发云平台需要具备以下能力：

- 代码托管服务（Gitlab，Github）
- CI/CD服务（Jenkins，Ansible，Docker）
- VM服务(Openstack，zstack，AWS，VMware）
- 容器服务（K8S，Mesos，Swarm）
- 服务注册/发现（etcd，zookeeper）
- 日志服务（ELK）
- 负载均衡（LVS，HAproxy，nginx）
- 监控服务（zabbix）
- VPC服务
- DNS服务
- 各类存储服务（文件，对象，MySql等）

尽可能多的去用平台的上述能力，把专业的事情交给专业的人，什么都DIY太累太慢。

### CI/CD
CI（Continuous Integration），持续集成。
CD（Continuous Deployment），持续部署。

要确保每个程序猿提交的代码都是单元测试通过，可以运行提供服务的代码。代码需要少量多次提交，代码提交之后自动生成安装包，提供给下一个环节使用。

一般安装包需要进入测试环境或者灰度环境运行，认为ok之后，才会进入实际生产环境。无论叫啥，总之是要把代码部署起来，提供服务，称为CD。

### 吃自己的狗粮
如果代码部署起来，只是放在那里，是不产生价值的，但是一般项目初始阶段是找不到用户的，咋办？

自己想办法用自己的东西呗，没有条件创造条件也要用起来。吃自己的狗粮是提升研发乐趣和研发质量极好的手段。

### 微服务化
为了让每个团队能够独立的开发测试部署升级自己的代码，并且对外提供服务，那么必须要把工作限定在一个比较小的范围，我们称之为微服务。

每个微服务通过网络消息提供服务接口，比如Rest API，RPC，消息队列等。

### 所有人能看到所有的代码
最牛逼的技术公司Google，20亿行代码是放在一个库中的，几乎所有的代码都是全员开放的。能够极快的检索，极其方便的共享，避免重复劳动，而且鼓励每个人都可以修改任何代码，只要review意见通过即可合入。

### 弘扬工程师文化
记得与Rancher的梁胜博士交流的时候，梁博在给我分享rancher的过程中，多次切换到Rancher的平台，现场操作演示rancher的各项功能。

但是很多大公司，这样的技术交流很少，PPT文化非常严重。

IT是个工程领域，IT是要`do`出来的，不信你看：Just *`do`* IT～

Talk is cheap，show me the code～